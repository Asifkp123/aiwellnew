# Clean Architecture Data Flow Diagram

## Overview
This diagram shows the complete data flow through all layers of Clean Architecture, from user interaction to API response and back to the UI.

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           DATA FLOW DIAGRAM                                   │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                                 VIEW LAYER                                    │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │   User Input    │    │   UI State      │    │   Navigation    │          │
│  │   (Button Tap)  │    │   (Loading)     │    │   (Route Push)  │          │
│  └─────────┬───────┘    └─────────┬───────┘    └─────────┬───────┘          │
│            │                      │                      │                    │
│            ▼                      ▼                      ▼                    │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                    VIEW MODEL LAYER                                   │   │
│  │  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐   │   │
│  │  │   UI Validation │    │   State Stream  │    │   UseCase Call  │   │   │
│  │  │   (Input Check) │    │   (Loading/Data)│    │   (execute())   │   │   │
│  │  └─────────┬───────┘    └─────────┬───────┘    └─────────┬───────┘   │   │
│  │            │                      │                      │             │   │
│  │            ▼                      ▼                      ▼             │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │   │
│  │  │                    USECASE LAYER                             │   │   │
│  │  │  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐│   │   │
│  │  │  │ Business Logic  │    │   Validation    │    │ Repository  ││   │   │
│  │  │  │   (Rules)       │    │   (Domain)      │    │   Call      ││   │   │
│  │  │  └─────────┬───────┘    └─────────┬───────┘    └─────┬───────┘│   │   │
│  │  │            │                      │                  │         │   │   │
│  │  │            ▼                      ▼                  ▼         │   │   │
│  │  │  ┌─────────────────────────────────────────────────────────┐   │   │   │
│  │  │  │                REPOSITORY LAYER                       │   │   │   │
│  │  │  │  ┌─────────────────┐    ┌─────────────────┐    ┌─────┐│   │   │   │
│  │  │  │  │ Data Source     │    │   Model         │    │ API ││   │   │   │   │
│  │  │  │  │   Selection     │    │   Mapping       │    │ Call││   │   │   │   │
│  │  │  │  └─────────┬───────┘    └─────────┬───────┘    └─┬───┘│   │   │   │   │
│  │  │  │            │                      │              │     │   │   │   │   │
│  │  │  │            ▼                      ▼              ▼     │   │   │   │   │
│  │  │  │  ┌─────────────────────────────────────────────────┐   │   │   │   │   │
│  │  │  │  │              DATA SOURCE LAYER                 │   │   │   │   │   │
│  │  │  │  │  ┌─────────────────┐    ┌─────────────────┐   │   │   │   │   │   │
│  │  │  │  │  │   HTTP Client   │    │   Response      │   │   │   │   │   │   │   │
│  │  │  │  │  │   (API Call)    │    │   Handling      │   │   │   │   │   │   │   │
│  │  │  │  │  └─────────┬───────┘    └─────────┬───────┘   │   │   │   │   │   │   │
│  │  │  │  │            │                      │           │   │   │   │   │   │   │
│  │  │  │  │            ▼                      ▼           │   │   │   │   │   │   │
│  │  │  │  │  ┌─────────────────────────────────────────┐   │   │   │   │   │   │   │
│  │  │  │  │  │              EXTERNAL API              │   │   │   │   │   │   │   │
│  │  │  │  │  │  ┌─────────────────┐    ┌─────────────┐│   │   │   │   │   │   │   │
│  │  │  │  │  │  │   Request       │    │   Response  ││   │   │   │   │   │   │   │
│  │  │  │  │  │  │   Processing    │    │   (JSON)    ││   │   │   │   │   │   │   │
│  │  │  │  │  │  └─────────────────┘    └─────────────┘│   │   │   │   │   │   │   │
│  │  │  │  │  └─────────────────────────────────────────┘   │   │   │   │   │   │   │
│  │  │  │  └─────────────────────────────────────────────┘   │   │   │   │   │   │   │
│  │  │  └─────────────────────────────────────────────────┘   │   │   │   │   │   │
│  │  └─────────────────────────────────────────────────────┘   │   │   │   │   │
│  └─────────────────────────────────────────────────────────┘   │   │   │   │   │
└─────────────────────────────────────────────────────────────────┘   │   │   │   │

┌─────────────────────────────────────────────────────────────────────────────────┐
│                           DATA FLOW STEPS                                     │
└─────────────────────────────────────────────────────────────────────────────────┘

1. USER INTERACTION
   ┌─────────────┐
   │ Button Tap  │ ──→ Triggers ViewModel function
   └─────────────┘

2. VIEW MODEL PROCESSING
   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
   │ UI Validation│ ──→│ State Stream│ ──→│ UseCase Call│
   └─────────────┘    └─────────────┘    └─────────────┘

3. USECASE EXECUTION
   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
   │ Business    │ ──→│ Domain      │ ──→│ Repository  │
   │ Logic       │    │ Validation  │    │ Call        │
   └─────────────┘    └─────────────┘    └─────────────┘

4. REPOSITORY OPERATION
   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
   │ Data Source │ ──→│ Model       │ ──→│ API Call    │
   │ Selection   │    │ Mapping     │    │ Preparation │
   └─────────────┘    └─────────────┘    └─────────────┘

5. DATA SOURCE EXECUTION
   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
   │ HTTP Client │ ──→│ API Request │ ──→│ External    │
   │ Setup       │    │ (JSON)      │    │ API         │
   └─────────────┘    └─────────────┘    └─────────────┘

6. RESPONSE FLOW (Reverse Direction)
   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
   │ API Response│ ──→│ Response    │ ──→│ Model       │
   │ (JSON)      │    │ Handling    │    │ Mapping     │
   └─────────────┘    └─────────────┘    └─────────────┘

7. DATA TRANSFORMATION
   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
   │ Domain      │ ──→│ State       │ ──→│ UI Update   │
   │ Entity      │    │ Update      │    │ (Display)   │
   └─────────────┘    └─────────────┘    └─────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                           ERROR FLOW                                          │
└─────────────────────────────────────────────────────────────────────────────────┘

ERROR HANDLING PATH:
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ API Error   │ ──→│ Repository  │ ──→│ UseCase     │ ──→│ ViewModel   │
│ (4xx/5xx)   │    │ Error       │    │ Error       │    │ Error       │
│             │    │ Handling    │    │ Handling    │    │ Handling    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
                                                              │
                                                              ▼
                                                    ┌─────────────┐
                                                    │ UI Error    │
                                                    │ Display     │
                                                    └─────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                           STREAM FLOW                                         │
└─────────────────────────────────────────────────────────────────────────────────┘

STREAM-BASED COMMUNICATION:
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ ViewModel   │ ──→│ Stream      │ ──→│ View        │ ──→│ UI Update   │
│ State       │    │ Controller  │    │ Listener    │    │ (Reactive)  │
│ Change      │    │ (Stream)    │    │ (Stream)    │    │             │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                           EXAMPLE: CREATE PAL FLOW                            │
└─────────────────────────────────────────────────────────────────────────────────┘

1. USER INTERACTION
   ┌─────────────┐
   │ "Create Pal"│ ──→ ViewModel.createPal()
   │ Button Tap  │
   └─────────────┘

2. VIEW MODEL
   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
   │ Validate    │ ──→│ Set Loading │ ──→│ Call        │
   │ Input       │    │ State       │    │ CreatePal   │
   │             │    │             │    │ UseCase     │
   └─────────────┘    └─────────────┘    └─────────────┘

3. USECASE
   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
   │ Business    │ ──→│ Domain      │ ──→│ Call        │
   │ Rules       │    │ Validation  │    │ PalRepo     │
   │             │    │             │    │ .createPal()│
   └─────────────┘    └─────────────┘    └─────────────┘

4. REPOSITORY
   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
   │ Map to      │ ──→│ Call        │ ──→│ API         │
   │ Request     │    │ Remote      │    │ Endpoint    │
   │ Model       │    │ DataSource  │    │             │
   └─────────────┘    └─────────────┘    └─────────────┘

5. DATA SOURCE
   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
   │ HTTP POST   │ ──→│ API Call    │ ──→│ Server      │
   │ Request     │    │ /api/pals   │    │ Processing  │
   └─────────────┘    └─────────────┘    └─────────────┘

6. RESPONSE FLOW
   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
   │ Server      │ ──→│ JSON        │ ──→│ Response    │
   │ Response    │    │ Response    │    │ Model       │
   └─────────────┘    └─────────────┘    └─────────────┘

7. UI UPDATE
   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
   │ Domain      │ ──→│ Stream      │ ──→│ UI          │
   │ Entity      │    │ Update      │    │ Success     │
   │             │    │             │    │ Display     │
   └─────────────┘    └─────────────┘    └─────────────┘ 